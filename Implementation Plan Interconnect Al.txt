Implementation Plan: Interconnect All Trayvorix Pages and Functions
Goal Description
Transform Trayvorix from a UI-focused demo application into a fully interconnected inventory management system where all pages, functions, and operations work together with real business logic, data relationships, and automated workflows.

Current State:

Pages display data but don't interact with each other
Operations (receipts, deliveries, adjustments) don't update inventory
No real-time synchronization between related entities
Business logic is missing (e.g., stock updates, low stock alerts, audit trails)
Sample data is static and disconnected
Target State:

All operations automatically update inventory levels
Real-time data synchronization across all pages
Complete audit trail for all transactions
Automated notifications for business events
Proper data relationships and cascading updates
End-to-end workflows (receipt → inventory → delivery)
User Review Required
IMPORTANT

Data Flow Changes This implementation will create real data relationships where:

Creating a receipt will automatically increase inventory
Creating a delivery will automatically decrease inventory
Adjustments will modify stock levels and create audit logs
All operations will be interconnected through the database
WARNING

Database Dependencies This requires Supabase to be properly configured. The demo mode will continue to work with sample data, but full mode requires:

All database migrations to be run
Proper RLS policies configured
Real-time subscriptions enabled
Proposed Changes
Component 1: Core Data Services Layer
Create centralized service modules for all entities with proper CRUD operations and business logic.

[NEW] 
inventory.service.ts
Functions to get inventory by product, warehouse, location
Update inventory quantities with transaction support
Check stock availability before operations
Calculate total inventory value
Get low stock items based on reorder points
[NEW] 
products.service.ts
CRUD operations for products
Get products with inventory levels
Get products by category, warehouse
Batch operations for bulk updates
[NEW] 
stockMovements.service.ts
Create stock movement records
Automatically update inventory on movement
Get movement history with filters
Generate movement reports
[NEW] 
warehouses.service.ts
Get warehouses with capacity calculations
Get warehouse inventory summary
Update warehouse status and metadata
Component 2: Business Logic Hooks
Create custom React hooks that encapsulate business logic and data fetching.

[NEW] 
useInventory.ts
Hook for fetching and managing inventory data
Real-time subscriptions to inventory changes
Optimistic updates for better UX
[NEW] 
useStockMovements.ts
Hook for creating and tracking stock movements
Automatic inventory updates
Transaction rollback on errors
[NEW] 
useNotifications.ts
Real-time notification subscriptions
Mark notifications as read
Filter by type and priority
Component 3: Enhanced Page Interconnections
Update all pages to use the new services and hooks, creating real data flow.

[MODIFY] 
Dashboard.tsx
Connect to real inventory service for KPIs
Show real-time low stock alerts from inventory
Display actual pending transfers from database
Link to related pages (click low stock → Products page filtered)
Real-time activity feed from stock_movements table
[MODIFY] 
Products.tsx
Show current inventory levels for each product
Display inventory across all warehouses
Add "View Inventory" button linking to inventory details
Show recent movements for each product
Implement edit and delete with proper validation
[MODIFY] 
Receipts.tsx
Create receipt with line items (products + quantities)
Validate receipt → automatically increase inventory
Create stock_movement records
Generate audit logs
Update receipt status workflow (draft → waiting → done)
Show real-time inventory impact
[MODIFY] 
Deliveries.tsx
Create delivery with line items
Check stock availability before creating delivery
Validate delivery → automatically decrease inventory
Create stock_movement records
Update delivery status workflow (draft → picking → packing → shipped)
Reserve stock during picking phase
[MODIFY] 
Adjustments.tsx
Create adjustment with reason and approval workflow
Pending adjustments require admin approval
Approved adjustments update inventory immediately
Create audit logs for all adjustments
Show before/after inventory levels
[MODIFY] 
MoveHistory.tsx
Display all stock movements from all sources (receipts, deliveries, adjustments, transfers)
Filter by product, warehouse, date range, movement type
Show detailed movement chain (source → destination)
Export movement reports
[MODIFY] 
Warehouses.tsx
Show real inventory levels per warehouse
Display capacity utilization from actual inventory
List products stored in each warehouse
Show recent movements for warehouse
Link to warehouse-specific inventory view
[MODIFY] 
Analytics.tsx
Calculate real metrics from stock_movements
Inventory turnover ratio from movements
Stock velocity analysis
Warehouse utilization charts
Product performance metrics
Component 4: Modal Components with Full Functionality
Create fully functional modal components for operations.

[MODIFY] 
AddProductModal.tsx
Form validation with Zod
Create product with initial inventory
Support for multiple barcodes
Category selection from database
Success callback to refresh parent
[MODIFY] 
AddReceiptModal.tsx
Multi-step form (supplier info → add products → confirm)
Product search and selection
Quantity input with validation
Calculate total items
Create receipt + receipt_lines + stock_movements in transaction
Update inventory atomically
[MODIFY] 
AddDeliveryModal.tsx
Multi-step form (customer info → add products → confirm)
Check stock availability in real-time
Show available quantity per product
Prevent over-delivery
Create delivery + delivery_lines + stock_movements in transaction
Reserve/decrease inventory atomically
[NEW] 
AddAdjustmentModal.tsx
Select product and location
Enter quantity change (+/-)
Select reason (damage, theft, cycle_count, expiry, other)
Add notes
Create adjustment record
Admin approval workflow
Component 5: Real-Time Synchronization
Implement real-time data updates across all pages.

[NEW] 
useRealtimeSubscription.ts
Generic hook for Supabase real-time subscriptions
Auto-cleanup on unmount
Error handling and reconnection
[MODIFY] 
Dashboard.tsx
Subscribe to inventory changes
Subscribe to stock_movements for activity feed
Subscribe to notifications
Auto-refresh KPIs on data changes
[MODIFY] 
Products.tsx
Subscribe to product changes
Subscribe to inventory changes for real-time stock levels
Component 6: Enhanced Sample Data
Improve sample data to demonstrate interconnected functionality.

[MODIFY] 
sampleData.ts
Add inventory levels for each product
Add detailed receipt line items
Add detailed delivery line items
Add movement history showing complete chains
Add notifications for low stock, expiring batches
Make data relationships clear and consistent
Component 7: Inventory Page Implementation
Create the missing Inventory page to show stock levels.

[NEW] 
Inventory.tsx
Display inventory grouped by product
Show quantity by warehouse and location
Display batch information with expiry dates
Show reserved quantities
Filter by warehouse, product, low stock
Export inventory reports
Link to product details and movement history
Component 8: Notification System
Implement automated notifications for business events.

[MODIFY] 
notifications.ts
Create notification on low stock (when inventory < reorder_point)
Create notification on batch expiry (30 days before)
Create notification on adjustment approval needed
Create notification on transfer request
Mark notifications as read
Delete old notifications
[NEW] 
NotificationCenter.tsx
Dropdown showing recent notifications
Badge with unread count
Click notification to navigate to related page
Mark as read functionality
Real-time updates via subscription
Verification Plan
Automated Tests
Since this project doesn't have existing tests, verification will be primarily manual and browser-based.

Manual Verification
Test 1: End-to-End Receipt Flow
Start dev server: npm run dev
Login to demo mode: http://localhost:5173/demo
Navigate to Receipts page
Click "New Receipt" button
Fill in supplier name: "Test Supplier"
Add product: "Steel Rods (10mm)", quantity: 50
Submit receipt
Expected: Receipt created with status "draft"
Navigate to Products page
Find "Steel Rods (10mm)"
Expected: Inventory should show +50 units (if receipt auto-validates) OR same level (if draft)
Navigate to Move History page
Expected: New movement record showing receipt of 50 units
Navigate to Dashboard
Expected: Activity feed shows recent receipt
Test 2: End-to-End Delivery Flow
Navigate to Deliveries page
Click "New Delivery Order"
Fill in customer name: "Test Customer"
Add product: "Steel Rods (10mm)", quantity: 20
Expected: System checks stock availability
Submit delivery
Expected: Delivery created
Navigate to Products page
Expected: Inventory decreased by 20 units
Navigate to Move History
Expected: New movement record showing delivery of 20 units
Test 3: Inventory Adjustment Flow
Navigate to Adjustments page
Click "New Adjustment"
Select product: "Portland Cement"
Enter quantity change: -5
Select reason: "damage"
Add notes: "Water damage"
Submit adjustment
Expected: Adjustment created with "pending" status (if user is not admin)
If admin, approve adjustment
Navigate to Products page
Expected: Inventory decreased by 5 units
Navigate to Move History
Expected: Adjustment movement recorded
Test 4: Real-Time Dashboard Updates
Open Dashboard in browser window 1
Note current KPI values (total products, inventory value, low stock items)
Open Products page in browser window 2
Add a new product in window 2
Expected: Dashboard in window 1 auto-updates with new total products count
Create a receipt in window 2
Expected: Dashboard inventory value updates in window 1
Test 5: Product-Inventory Interconnection
Navigate to Products page
Click on any product row
Expected: Shows product details with current inventory levels
Expected: Shows inventory breakdown by warehouse
Expected: Shows recent movements for this product
Click "View Full History"
Expected: Navigates to Move History page filtered for this product
Test 6: Warehouse-Inventory Connection
Navigate to Warehouses page
View warehouse "Mumbai Central Hub"
Expected: Shows real capacity utilization based on actual inventory
Expected: Lists all products stored in this warehouse
Click on a product in the warehouse
Expected: Navigates to product details or inventory view
Test 7: Low Stock Alerts
Navigate to Dashboard
Expected: Low Stock Items KPI shows count of products below reorder point
Click on Low Stock Items card
Expected: Navigates to Products page filtered to show only low stock items
Expected: Products with quantity < reorder_point are highlighted
Test 8: Supabase Real Mode (if configured)
Ensure Supabase is configured with proper credentials
Login at http://localhost:5173/login with real credentials
Repeat Tests 1-7 in real mode
Expected: All operations persist to database
Expected: Data survives page refresh
Open Supabase dashboard
Expected: Verify data in tables (products, inventory, stock_movements)
Implementation Notes
All database operations will use transactions to ensure data consistency
Error handling will rollback changes if any step fails
Demo mode will continue to work with enhanced sample data
Real mode requires Supabase configuration
Real-time subscriptions will only work in real mode
All operations will create audit logs for traceability
Optimistic UI updates for better user experience